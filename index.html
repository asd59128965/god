<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神祇・宮廟數位導覽</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Noto Serif TC (宋體) & Ma Shan Zheng (書法) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+TC:wght@300;500;700&display=swap" rel="stylesheet">

    <!-- GSAP & Lenis -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>

    <style>
        :root {
            --c-gold: #D4AF37;
            --c-gold-light: #F9E08E;
            --c-red: #8B0000;
            --c-dark: #0F0F0F;
        }

        body {
            background-color: var(--c-dark);
            color: #e5e5e5;
            font-family: 'Noto Serif TC', serif;
            overflow-x: hidden;
            cursor: none; /* 隱藏預設游標 */
        }

        /* 噪點紋理背景 */
        .noise-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* 書法字體類 */
        .font-calligraphy {
            font-family: 'Ma Shan Zheng', cursive;
        }

        /* 直排文字 */
        .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            letter-spacing: 0.5em;
        }

        /* 金色漸層文字 */
        .gold-text {
            background: linear-gradient(to bottom, var(--c-gold-light), var(--c-gold), #8a6e18);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0px 0px 20px rgba(212, 175, 55, 0.3);
        }

        /* 自定義游標：光暈 */
        #cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 12px;
            height: 12px;
            background-color: var(--c-gold);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
            box-shadow: 0 0 20px 5px rgba(212, 175, 55, 0.6);
            transition: transform 0.2s;
        }
        
        #cursor-follower {
            position: fixed;
            top: 0;
            left: 0;
            width: 40px;
            height: 40px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9998;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s, opacity 0.3s;
        }

        /* 捲軸效果遮罩 */
        .scroll-reveal-img {
            clip-path: inset(10% 10% 10% 10%);
            filter: sepia(0.5) contrast(1.1);
            transition: filter 0.5s;
        }
        .scroll-reveal-img:hover {
            filter: sepia(0) contrast(1);
        }

        /* 煙霧動畫容器 */
        .smoke-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            z-index: 10;
        }
        
        /* 裝飾印章 */
        .seal {
            border: 2px solid #a83232;
            color: #a83232;
            padding: 8px 4px;
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.2rem;
            display: inline-block;
            border-radius: 4px;
            opacity: 0.8;
            box-shadow: 0 0 10px rgba(168, 50, 50, 0.2);
        }
    </style>
</head>
<body>

    <!-- 噪點遮罩 -->
    <div class="noise-bg"></div>
    
    <!-- 游標 -->
    <div id="cursor"></div>
    <div id="cursor-follower"></div>

    <!-- 載入動畫 (開場) -->
    <div id="loader" class="fixed inset-0 bg-black z-[100] flex flex-col justify-center items-center text-[#D4AF37]">
        <div class="text-4xl font-calligraphy animate-pulse tracking-widest">誠心 • 敬拜</div>
        <div class="mt-4 w-32 h-[1px] bg-[#D4AF37]/30 relative overflow-hidden">
            <div class="absolute inset-0 bg-[#D4AF37] w-full h-full -translate-x-full" id="loader-bar"></div>
        </div>
    </div>

    <!-- 導覽列 -->
    <nav class="fixed top-0 w-full p-8 flex justify-between items-start z-40 mix-blend-difference">
        <div class="vertical-text text-2xl font-bold text-[#D4AF37] tracking-widest border-r-2 border-[#D4AF37] pr-2 h-24">
            天運歲次
        </div>
        <div class="flex flex-col gap-6 text-sm tracking-[0.3em] font-light text-white/80">
            <a href="#" class="hover:text-[#D4AF37] transition-colors interactable">緣起</a>
            <a href="#" class="hover:text-[#D4AF37] transition-colors interactable">神尊</a>
            <a href="#" class="hover:text-[#D4AF37] transition-colors interactable">參拜</a>
        </div>
    </nav>

    <!-- 第一幕：主視覺 (Hero) -->
    <header class="relative w-full h-screen flex justify-center items-center overflow-hidden">
        <!-- 背景圖：整合圖片 1 作為開場氛圍 -->
        <div class="absolute inset-0 z-0">
            <img src="messageImage_1765872088875.jpg" class="w-full h-full object-cover opacity-60 scale-110 hero-img" alt="Temple Main Visual">
            <!-- 漸層遮罩，製造神祕感 -->
            <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-[#0a0a0a]/50 to-transparent"></div>
            <div class="absolute inset-0 bg-gradient-to-r from-[#0a0a0a] via-transparent to-[#0a0a0a]"></div>
        </div>

        <!-- 煙霧效果 (CSS 模擬) -->
        <div class="smoke-container opacity-50">
            <!-- 這裡可以用 JS 生成更多煙霧粒子，暫時用氛圍光代替 -->
            <div class="absolute bottom-[-20%] left-[20%] w-[500px] h-[500px] bg-gray-500 rounded-full blur-[150px] opacity-20 animate-pulse"></div>
            <div class="absolute bottom-[-20%] right-[20%] w-[600px] h-[600px] bg-[#8B0000] rounded-full blur-[150px] opacity-20 animate-pulse" style="animation-delay: 1s;"></div>
        </div>

        <!-- 中央主標題 -->
        <div class="relative z-10 flex flex-col items-center gap-8">
            <div class="seal mb-4 interactable">敕封展覽</div>
            <h1 class="vertical-text font-calligraphy text-7xl md:text-9xl gold-text leading-tight tracking-widest opacity-0 hero-text">
                神威顯赫
            </h1>
            <p class="text-[#e5e5e5]/70 tracking-[0.5em] mt-8 text-sm md:text-base border-t border-[#D4AF37]/50 pt-4 opacity-0 hero-text">
                百年香火 • 世代傳承
            </p>
        </div>
    </header>

    <!-- 第二幕：引言 (Scroll Text) -->
    <section class="min-h-[80vh] w-full flex flex-col justify-center items-center py-20 px-6 relative bg-[#0F0F0F]">
        <div class="max-w-3xl text-center space-y-12">
            <p class="text-2xl md:text-4xl font-light leading-loose text-white/90 reveal-text">
                入廟見神，<span class="text-[#D4AF37]">心誠則靈</span>。<br>
                每一縷香煙，都是人與天的對話。
            </p>
            <p class="text-base text-gray-400 leading-relaxed reveal-text tracking-widest">
                此地承載著百年的信仰與記憶，<br>透過數位影像，我們將神明的莊嚴與慈悲，<br>永久留存在這方寸之間。
            </p>
            <div class="w-[1px] h-32 bg-gradient-to-b from-[#D4AF37] to-transparent mx-auto mt-10 reveal-line"></div>
        </div>
    </section>

    <!-- 第三幕：橫向捲軸畫廊 (Gallery) -->
    <!-- 模擬「看畫卷」的體驗，圖片會非常大 -->
    <section id="gallery-container" class="relative w-full h-screen bg-[#0a0a0a] overflow-hidden flex items-center">
        <!-- 背景裝飾文字 -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-[20vw] opacity-[0.03] font-calligraphy pointer-events-none select-none text-[#8B0000]">
            風調雨順
        </div>

        <div class="gallery-wrapper flex px-[5vw] h-[80vh] items-center gap-[10vw] w-fit">
            
            <!-- 介紹卡 -->
            <div class="w-[30vw] h-full flex flex-col justify-center shrink-0">
                <h2 class="vertical-text text-5xl font-bold text-[#D4AF37] mb-8 font-calligraphy">鎮殿金身</h2>
                <p class="vertical-text text-white/60 text-lg leading-10 h-[60%] border-r border-white/20 pr-8">
                    仰望神顏，如見真理。<br>
                    金身不壞，慈悲常在。<br>
                    細節之處，皆是匠心。
                </p>
            </div>

            <!-- 圖片 1：大型展示 (整合分析文案) -->
            <div class="w-[80vw] md:w-[60vw] h-full relative shrink-0 interactable gallery-item">
                <div class="absolute inset-0 border border-[#D4AF37]/30 z-20 m-4 pointer-events-none"></div>
                <img src="messageImage_1765872088875.jpg" class="w-full h-full object-cover scroll-reveal-img" alt="神韻靈動">
                <div class="absolute bottom-10 right-10 z-30 bg-black/80 px-4 py-6 border-l-2 border-[#D4AF37]">
                    <div class="vertical-text text-xl font-bold text-[#D4AF37]">神韻靈動</div>
                    <div class="mt-4 text-xs text-gray-400 vertical-text h-32 tracking-widest leading-loose">
                        光影流轉 • 慈悲法相
                    </div>
                </div>
            </div>

            <!-- 圖片 2：大型展示 (整合分析文案) -->
            <div class="w-[80vw] md:w-[60vw] h-full relative shrink-0 interactable gallery-item">
                <div class="absolute inset-0 border border-[#D4AF37]/30 z-20 m-4 pointer-events-none"></div>
                <img src="messageImage_1765873756410.jpg" class="w-full h-full object-cover scroll-reveal-img" alt="肅穆莊嚴">
                <div class="absolute bottom-10 right-10 z-30 bg-black/80 px-4 py-6 border-l-2 border-[#D4AF37]">
                    <div class="vertical-text text-xl font-bold text-[#D4AF37]">肅穆莊嚴</div>
                     <div class="mt-4 text-xs text-gray-400 vertical-text h-32 tracking-widest leading-loose">
                        威儀棣棣 • 護國佑民
                    </div>
                </div>
            </div>

            <!-- 結語卡 -->
            <div class="w-[40vw] h-full flex items-center justify-center shrink-0">
                 <h2 class="vertical-text text-6xl font-calligraphy text-white/20">合境平安</h2>
            </div>
        </div>
    </section>

    <!-- 第四幕：互動參拜 (Footer) -->
    <footer class="relative min-h-screen w-full flex flex-col justify-center items-center bg-[#0F0F0F] overflow-hidden">
        <!-- 背景光暈 -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-[#D4AF37] rounded-full blur-[200px] opacity-10 animate-pulse"></div>
        
        <div class="z-10 text-center space-y-12">
            <div class="seal mx-auto border-[#D4AF37] text-[#D4AF37]">線上祈福</div>
            
            <h2 class="text-5xl md:text-7xl font-calligraphy text-white mb-8">願 心 所 向</h2>
            
            <!-- 互動按鈕 -->
            <button class="relative group px-12 py-4 overflow-hidden border border-[#D4AF37] text-[#D4AF37] hover:text-black transition-colors duration-500 interactable">
                <span class="relative z-10 text-xl tracking-[0.5em] font-bold">點擊參拜</span>
                <div class="absolute inset-0 bg-[#D4AF37] translate-y-full group-hover:translate-y-0 transition-transform duration-500 ease-out"></div>
            </button>

            <div class="mt-20 flex gap-8 justify-center text-xs tracking-widest text-gray-600">
                <span>© 2025 廟宇導覽系統</span>
                <span>設計：數位工坊</span>
            </div>
        </div>
    </footer>

    <script>
        // 1. Loader 動畫
        window.addEventListener('load', () => {
            const tl = gsap.timeline();
            tl.to("#loader-bar", { x: "0%", duration: 1, ease: "power2.inOut" })
              .to("#loader", { opacity: 0, duration: 1, delay: 0.2, pointerEvents: "none" })
              .add(() => initAnimations()); // 載入完畢後啟動其他動畫
        });

        // 2. 初始化 Lenis 平滑滾動
        const lenis = new Lenis({
            duration: 1.5, // 增加持續時間，讓滾動更有「沉重感」
            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
            direction: 'vertical',
            gestureDirection: 'vertical',
            smooth: true,
            mouseMultiplier: 1,
            smoothTouch: false,
            touchMultiplier: 2,
        });

        function raf(time) {
            lenis.raf(time);
            requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
        gsap.registerPlugin(ScrollTrigger);

        // 3. 自定義游標 (光點 + 延遲圈)
        const cursor = document.getElementById('cursor');
        const follower = document.getElementById('cursor-follower');
        
        document.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0.1 });
            gsap.to(follower, { x: e.clientX, y: e.clientY, duration: 0.4 });
        });

        // 游標互動放大效果
        document.querySelectorAll('.interactable').forEach(el => {
            el.addEventListener('mouseenter', () => {
                gsap.to(cursor, { scale: 2, duration: 0.3 });
                gsap.to(follower, { scale: 1.5, borderColor: "#D4AF37", borderWidth: "2px", duration: 0.3 });
            });
            el.addEventListener('mouseleave', () => {
                gsap.to(cursor, { scale: 1, duration: 0.3 });
                gsap.to(follower, { scale: 1, borderColor: "rgba(212, 175, 55, 0.3)", borderWidth: "1px", duration: 0.3 });
            });
        });

        function initAnimations() {
            // 4. Hero 文字進場
            gsap.to(".hero-text", {
                y: 0,
                opacity: 1,
                duration: 2,
                stagger: 0.3,
                ease: "power3.out"
            });
            
            // Hero 圖片視差 (Parallax)
            gsap.to(".hero-img", {
                yPercent: 20,
                ease: "none",
                scrollTrigger: {
                    trigger: "header",
                    start: "top top",
                    end: "bottom top",
                    scrub: true
                }
            });

            // 5. 引言文字浮現
            gsap.utils.toArray('.reveal-text').forEach(text => {
                gsap.from(text, {
                    y: 30,
                    opacity: 0,
                    duration: 1.5,
                    ease: "power2.out",
                    scrollTrigger: {
                        trigger: text,
                        start: "top 80%",
                        toggleActions: "play none none reverse"
                    }
                });
            });
            
            gsap.from('.reveal-line', {
                height: 0,
                duration: 1.5,
                scrollTrigger: {
                    trigger: '.reveal-line',
                    start: "top 70%"
                }
            });

            // 6. 橫向捲軸 (Gallery) - 修正版
            const galleryWrapper = document.querySelector('.gallery-wrapper');
            const gallerySection = document.querySelector('#gallery-container');
            
            // 計算滾動距離：內容總寬度 - 視窗寬度
            const scrollWidth = galleryWrapper.offsetWidth - window.innerWidth;

            // FIX: 將這個 Tween 存入變數，讓下面的 containerAnimation 可以參考到它
            const scrollTween = gsap.to(galleryWrapper, {
                x: -scrollWidth,
                ease: "none",
                scrollTrigger: {
                    trigger: gallerySection,
                    pin: true,
                    scrub: 1,
                    end: () => "+=" + scrollWidth,
                    invalidateOnRefresh: true
                }
            });

            // 圖片經過時的裁切/縮放效果
            gsap.utils.toArray('.gallery-item img').forEach(img => {
                gsap.to(img, {
                    clipPath: "inset(0% 0% 0% 0%)",
                    scale: 1.05,
                    scrollTrigger: {
                        trigger: img,
                        containerAnimation: scrollTween, // FIX: 這裡必須傳入上面的 scrollTween 實例，而不是 DOM 元素
                        start: "left center",
                        end: "right center",
                        scrub: true
                    }
                });
            });
        }

    </script>
</body>
</html>
